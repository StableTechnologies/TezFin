<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="492px" preserveAspectRatio="none" style="width:1722px;height:492px;" version="1.1" viewBox="0 0 1722 492" width="1722px" zoomAndPan="magnify"><defs><filter height="300%" id="f14yaik5pbb0zo" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="88.4883" y2="407.9727"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="168" x2="168" y1="88.4883" y2="407.9727"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1512" x2="1512" y1="88.4883" y2="407.9727"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="85.5352">User</text><ellipse cx="23.5" cy="15" fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,23 L23.5,50 M10.5,31 L36.5,31 M23.5,50 L10.5,65 M23.5,50 L36.5,65 " fill="none" filter="url(#f14yaik5pbb0zo)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="420.5078">User</text><ellipse cx="23.5" cy="433.4609" fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,441.4609 L23.5,468.4609 M10.5,449.4609 L36.5,449.4609 M23.5,468.4609 L10.5,483.4609 M23.5,468.4609 L36.5,483.4609 " fill="none" filter="url(#f14yaik5pbb0zo)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="118" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="125" y="73.5352">Comptroller</text><rect fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="118" y="406.9727"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="125" y="427.5078">Comptroller</text><rect fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="1477" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1484" y="73.5352">CToken</text><rect fill="#FEFECE" filter="url(#f14yaik5pbb0zo)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="1477" y="406.9727"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="1484" y="427.5078">CToken</text><polygon fill="#A80036" points="156.5,115.7988,166.5,119.7988,156.5,123.7988,160.5,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="162.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="30.5" y="115.0566">exitMarket(cToken)</text><polygon fill="#A80036" points="1500.5,145.1094,1510.5,149.1094,1500.5,153.1094,1504.5,149.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="168.5" x2="1506.5" y1="149.1094" y2="149.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="175.5" y="144.3672">getAccountSnapshot(sp.sender)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1554.5" y1="178.4199" y2="178.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1554.5" x2="1554.5" y1="178.4199" y2="191.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1513.5" x2="1554.5" y1="191.4199" y2="191.4199"/><polygon fill="#A80036" points="1523.5,187.4199,1513.5,191.4199,1523.5,195.4199,1519.5,191.4199" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1519.5" y="173.6777">verifyAccrueItnerestRelevance()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1554.5" y1="220.7305" y2="220.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1554.5" x2="1554.5" y1="220.7305" y2="233.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1513.5" x2="1554.5" y1="233.7305" y2="233.7305"/><polygon fill="#A80036" points="1523.5,229.7305,1513.5,233.7305,1523.5,237.7305,1519.5,233.7305" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1519.5" y="215.9883">getBorrowBalance(params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1554.5" y1="263.041" y2="263.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1554.5" x2="1554.5" y1="263.041" y2="276.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1513.5" x2="1554.5" y1="276.041" y2="276.041"/><polygon fill="#A80036" points="1523.5,272.041,1513.5,276.041,1523.5,280.041,1519.5,276.041" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="1519.5" y="258.2988">exchangeRateStoredImpl()</text><polygon fill="#A80036" points="179.5,301.3516,169.5,305.3516,179.5,309.3516,175.5,305.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="173.5" x2="1511.5" y1="305.3516" y2="305.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1320" x="185.5" y="300.6094">setAccountSnapAndExitMarket(account = params, cTokenBalance = self.data.balances[params].balance, borrowBalance = self.getBorrowBalance(params), exchangeRateMantissa = self.exchangeRateStoredImpl())</text><line style="stroke:#A80036;stroke-width:1.0;" x1="168.5" x2="210.5" y1="334.6621" y2="334.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210.5" x2="210.5" y1="334.6621" y2="347.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="169.5" x2="210.5" y1="347.6621" y2="347.6621"/><polygon fill="#A80036" points="179.5,343.6621,169.5,347.6621,179.5,351.6621,175.5,347.6621" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="792" x="175.5" y="329.9199">redeemAllowedInternal(cToken = sp.sender, redeemer = accSnapshot.account, redeemAmount = accSnapshot.cTokenBalance)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="168.5" x2="210.5" y1="376.9727" y2="376.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="210.5" x2="210.5" y1="376.9727" y2="389.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="169.5" x2="210.5" y1="389.9727" y2="389.9727"/><polygon fill="#A80036" points="179.5,385.9727,169.5,389.9727,179.5,393.9727,175.5,389.9727" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="286" x="175.5" y="372.2305">invalidateLiquidity(accountSnapshot.account)</text><!--MD5=[a67a3ab758bfeb234ba2f428d53fe329]
@startuml
actor User
participant Comptroller
participant CToken

User -> Comptroller : exitMarket(cToken)
Comptroller -> CToken : getAccountSnapshot(sp.sender)
CToken -> CToken : verifyAccrueItnerestRelevance()
CToken -> CToken : getBorrowBalance(params)
CToken -> CToken : exchangeRateStoredImpl()
CToken -> Comptroller : setAccountSnapAndExitMarket(account = params, cTokenBalance = self.data.balances[params].balance, borrowBalance = self.getBorrowBalance(params), exchangeRateMantissa = self.exchangeRateStoredImpl())
Comptroller -> Comptroller : redeemAllowedInternal(cToken = sp.sender, redeemer = accSnapshot.account, redeemAmount = accSnapshot.cTokenBalance)
Comptroller -> Comptroller : invalidateLiquidity(accountSnapshot.account)
@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>