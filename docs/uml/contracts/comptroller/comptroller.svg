<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1144px" preserveAspectRatio="none" style="width:1873px;height:1144px;" version="1.1" viewBox="0 0 1873 1144" width="1873px" zoomAndPan="magnify"><defs><filter height="300%" id="f1q3fhcwp5m0pg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[78760213c7e05475d9138e630140d41e]
cluster Comptroller--><polygon fill="#FFFFFF" filter="url(#f1q3fhcwp5m0pg)" points="16,6,109,6,116,28.4883,1316,28.4883,1316,1137,16,1137,16,6" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="116" y1="28.4883" y2="28.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="87" x="20" y="21.5352">Comptroller</text><!--MD5=[d80a0acb219980f04c954dc799d0dcd0]
cluster Oracle--><polygon fill="#FFFFFF" filter="url(#f1q3fhcwp5m0pg)" points="1340,416,1392,416,1399,438.4883,1510,438.4883,1510,541,1340,541,1340,416" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1340" x2="1399" y1="438.4883" y2="438.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="46" x="1344" y="431.5352">Oracle</text><!--MD5=[aca7fdeb42d76c3bc727f7f8269e78e8]
cluster Exponential--><polygon fill="#FFFFFF" filter="url(#f1q3fhcwp5m0pg)" points="1534,422.5,1624,422.5,1631,444.9883,1646,444.9883,1646,534.5,1534,534.5,1534,422.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1534" x2="1631" y1="444.9883" y2="444.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="84" x="1538" y="438.0352">Exponential</text><!--MD5=[a9b42c28185654053bfaf63fb781d768]
cluster CToken--><polygon fill="#FFFFFF" filter="url(#f1q3fhcwp5m0pg)" points="1670,403,1731,403,1738,425.4883,1856,425.4883,1856,554,1670,554,1670,403" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1670" x2="1738" y1="425.4883" y2="425.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="55" x="1674" y="418.5352">CToken</text><!--MD5=[26f0c59113a92cd22835df7ebadbb4c7]
class Comptroller--><rect codeLine="2" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="894.0801" id="Comptroller" style="stroke:#A80036;stroke-width:1.5;" width="835" x="32.5" y="41"/><ellipse cx="411.75" cy="57" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M414.2231,63.1431 Q413.6421,63.4419 413.0029,63.5913 Q412.3638,63.7407 411.6582,63.7407 Q409.1514,63.7407 407.8315,62.0889 Q406.5117,60.437 406.5117,57.3159 Q406.5117,54.1865 407.8315,52.5347 Q409.1514,50.8828 411.6582,50.8828 Q412.3638,50.8828 413.0112,51.0322 Q413.6587,51.1816 414.2231,51.4805 L414.2231,54.2031 Q413.5923,53.6221 412.9988,53.3523 Q412.4053,53.0825 411.7744,53.0825 Q410.4297,53.0825 409.7449,54.1492 Q409.0601,55.2158 409.0601,57.3159 Q409.0601,59.4077 409.7449,60.4744 Q410.4297,61.541 411.7744,61.541 Q412.4053,61.541 412.9988,61.2712 Q413.5923,61.0015 414.2231,60.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="68" x="432.25" y="61.5352">Comptroller</text><line style="stroke:#A80036;stroke-width:1.5;" x1="33.5" x2="866.5" y1="73" y2="73"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="251" x="38.5" y="104.5898">map(address =&gt; set(address)) account_assets</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="38.5" y="117.5449">bool borrowAllowed()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="119" x="38.5" y="130.5">address administrator</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="165" x="38.5" y="143.4551">address pendingAdministrator</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="184" x="38.5" y="156.4102">map(address -&gt; TMarket) markets</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="256" x="38.5" y="169.3652">map(string -&gt; address) marketNameToAddress</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="108" x="38.5" y="182.3203">bool transferPaused</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="248" x="38.5" y="195.2754">map(address -&gt; set(address)) account_assets</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="823" x="38.5" y="208.2305">big_map(address -&gt; TLiquidity) account_liquidity = sp.big_map(l={}, tkey = sp.TAddress, tvalue = TLiquidity), # Per-account mapping of current liquidity</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="180" x="38.5" y="221.1855">oracleAddress = oracleAddress_,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="530" x="38.5" y="234.1406">activeOperations = sp.set(t=sp.TNat), # Set of currently active operations to protect execution flow</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="128" x="38.5" y="247.0957">TCalculation calculation</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="129" x="38.5" y="260.0508">nat closeFactorMantissa</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="38.5" y="273.0059">nat liquidationIncentiveMantissa</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="134" x="38.5" y="285.9609">nat pricePeriodRelevance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="150" x="38.5" y="298.916">nat liquidityPeriodRelevance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="33.5" x2="429.5" y1="87.4775" y2="87.4775"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="41" x="429.5" y="91.1348">storage</text><line style="stroke:#A80036;stroke-width:1.0;" x1="470.5" x2="866.5" y1="87.4775" y2="87.4775"/><ellipse cx="43.5" cy="325.1914" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="52.5" y="328.8262">enterMarkets(cTokens: list(address))</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="335.1465"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="309" x="52.5" y="341.7813">addToMarketInternal(ctoken: address, borrower: address)</text><ellipse cx="43.5" cy="351.1016" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="52.5" y="354.7363">exitMarket(ctoken: address)</text><ellipse cx="43.5" cy="364.0566" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="418" x="52.5" y="367.6914">setAccountSnapAndExitMarket(accountSnapshot: CToken.TAccountSnapshot)</text><ellipse cx="43.5" cy="377.0117" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="345" x="52.5" y="380.6465">mintAllowed(ctoken: address, minter: address, mintAmount: nat)</text><ellipse cx="43.5" cy="389.9668" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="393" x="52.5" y="393.6016">redeemAllowed(ctoken: address, redeemer: address, redeemAmount: nat)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="399.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="434" x="52.5" y="406.5566">redeemAllowedInternal(ctoken: address, redeemer: address, redeemAmount: nat)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="412.877"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="436" x="52.5" y="419.5117">checkInsufficientLquidityInternal(ctoken: address, account: address, amount: nat)</text><ellipse cx="43.5" cy="428.832" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="390" x="52.5" y="432.4668">borrowAllowed(ctoken: address, borrower: address, borrowAmount: nat)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="438.7871"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="184" x="52.5" y="445.4219">checkPriceErrors(ctoken: address)</text><ellipse cx="43.5" cy="454.7422" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="495" x="52.5" y="458.377">repayBorrowAllowed(ctoken: address, payer: address, borrower: address, repayAmount: nat)</text><ellipse cx="43.5" cy="467.6973" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="433" x="52.5" y="471.332">transferAllowed(ctoken: address, src: address, dst: address, transferTokens: nat)</text><ellipse cx="43.5" cy="480.6523" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="178" x="52.5" y="484.2871">updateAssetPrice(asset: address)</text><ellipse cx="43.5" cy="493.6074" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="403" x="52.5" y="497.2422">setAssetPrice((assetName, pricePair): (string, Oracle.TSetPricePriceParams))</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="503.5625"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="158" x="52.5" y="510.1973">getAssetPrice(asset: address)</text><ellipse cx="43.5" cy="519.5176" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="228" x="52.5" y="523.1523">updateAccountLiduiqity(account: address)</text><ellipse cx="43.5" cy="532.4727" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="115" x="52.5" y="536.1074">setAccountLiquidity()</text><ellipse cx="43.5" cy="545.4277" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="432" x="52.5" y="549.0625">getHypoAccountLiquidity(data: TAccountLiquidityParams, callback: contract(int))</text><ellipse cx="43.5" cy="558.3828" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="178" x="52.5" y="562.0176">int returnHypoAccountLiquidity()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="568.3379"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="280" x="52.5" y="574.9727">calcluateCurrentAccountLiquidity(account: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="581.293"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="238" x="52.5" y="587.9277">calcluateAccountLiquidity(account: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="594.248"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="492" x="52.5" y="600.8828">initCalculation(cTokenModify: address, account: address, redeemTokens: , borrowAmount: )</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="607.2031"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="52.5" y="613.8379">resetCalculation()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="620.1582"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="339" x="52.5" y="626.793">getAccountLiquidityForAsset(asset: address, account: address)</text><ellipse cx="43.5" cy="636.1133" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="324" x="52.5" y="639.748">calculateAccountAssetLiquidity(params: TAccountSnapshot)</text><ellipse cx="43.5" cy="649.0684" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="232" x="52.5" y="652.7031">setPricePeriodRelevance(blockNumber: nat)</text><ellipse cx="43.5" cy="662.0234" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="252" x="52.5" y="665.6582">setLiquidityPeriodRelevance(blockNumber: nat)</text><ellipse cx="43.5" cy="674.9785" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="299" x="52.5" y="678.6133">setPendingGovernance(pendingAdministrator: address)</text><ellipse cx="43.5" cy="687.9336" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="107" x="52.5" y="691.5684">acceptGovernance()</text><ellipse cx="43.5" cy="700.8887" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="235" x="52.5" y="704.5234">setMintPaused(cToken: address, state: bool)</text><ellipse cx="43.5" cy="713.8438" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="250" x="52.5" y="717.4785">setBorrowPaused(cToken: address, state: bool)</text><ellipse cx="43.5" cy="726.7988" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="164" x="52.5" y="730.4336">setTransferPaused(state: bool)</text><ellipse cx="43.5" cy="739.7539" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="196" x="52.5" y="743.3887">setPriceOracle(priceOracle: address)</text><ellipse cx="43.5" cy="752.709" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="220" x="52.5" y="756.3438">setCloseFactor(closeFactorMantissa: nat)</text><ellipse cx="43.5" cy="765.6641" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="332" x="52.5" y="769.2988">setCollateralFactor(cToken: address, newCollateralFactor: nat)</text><ellipse cx="43.5" cy="778.6191" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="307" x="52.5" y="782.2539">setLiquidationIncentive(liquidationIncentiveMantissa: nat)</text><ellipse cx="43.5" cy="791.5742" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="248" x="52.5" y="795.209">supportMarket(cToken: address, name: string)</text><ellipse cx="43.5" cy="804.5293" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="170" x="52.5" y="808.1641">disableMarket(cToken: address)</text><ellipse cx="43.5" cy="817.4844" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="316" x="52.5" y="821.1191">setMarketBorrowCap(cToken: address, newBorrowCap: nat)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="33.5" x2="417.5" y1="311.7139" y2="311.7139"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="65" x="417.5" y="315.3711">entry points</text><line style="stroke:#A80036;stroke-width:1.0;" x1="482.5" x2="866.5" y1="311.7139" y2="311.7139"/><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="844.3945"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="52.5" y="851.0293">verifyMarketExists(token: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="857.3496"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="52.5" y="863.9844">verifyMarketExists(token: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="870.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="204" x="52.5" y="876.9395">verifyMarketNotListed(token: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="883.2598"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="52.5" y="889.8945">verifyAdministrator()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="896.2148"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="79" x="52.5" y="902.8496">verifyInternal()</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="909.1699"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="217" x="52.5" y="915.8047">verifyLiquidityCorrect(account: address)</text><rect fill="#F24D5C" height="6" style="stroke:#C82930;stroke-width:1.0;" width="6" x="40.5" y="922.125"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="197" x="52.5" y="928.7598">invalidateLiquidity(account: address)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="33.5" x2="430" y1="833.917" y2="833.917"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="40" x="430" y="837.5742">helpers</text><line style="stroke:#A80036;stroke-width:1.0;" x1="470" x2="866.5" y1="833.917" y2="833.917"/><!--MD5=[134edbc2e7ce23baae0d3a0e896740b0]
class TMarket--><rect codeLine="70" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="151.6406" id="TMarket" style="stroke:#A80036;stroke-width:1.5;" width="266" x="903" y="412"/><ellipse cx="1007.75" cy="428" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1010.2231,434.1431 Q1009.6421,434.4419 1009.0029,434.5913 Q1008.3638,434.7407 1007.6582,434.7407 Q1005.1514,434.7407 1003.8315,433.0889 Q1002.5117,431.437 1002.5117,428.3159 Q1002.5117,425.1865 1003.8315,423.5347 Q1005.1514,421.8828 1007.6582,421.8828 Q1008.3638,421.8828 1009.0112,422.0322 Q1009.6587,422.1816 1010.2231,422.4805 L1010.2231,425.2031 Q1009.5923,424.6221 1008.9988,424.3523 Q1008.4053,424.0825 1007.7744,424.0825 Q1006.4297,424.0825 1005.7449,425.1492 Q1005.0601,426.2158 1005.0601,428.3159 Q1005.0601,430.4077 1005.7449,431.4744 Q1006.4297,432.541 1007.7744,432.541 Q1008.4053,432.541 1008.9988,432.2712 Q1009.5923,432.0015 1010.2231,431.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="48" x="1028.25" y="432.5352">TMarket</text><line style="stroke:#A80036;stroke-width:1.5;" x1="904" x2="1168" y1="444" y2="444"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="179" x="909" y="458.6348">Exponential.TExp collateralFactor</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="909" y="471.5898">bool mintPaused</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="909" y="484.5449">bool borrowPaused</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="64" x="909" y="497.5">string name</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="909" y="510.4551">Exponential.TExp price</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="909" y="523.4102">nat updateLevel</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="80" x="909" y="536.3652">nat borrowCap</text><line style="stroke:#A80036;stroke-width:1.5;" x1="904" x2="1168" y1="542.6855" y2="542.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="254" x="909" y="557.3203">big_map(address -&gt; bool) accountMembership</text><!--MD5=[16b26ee9960e8e801bf4156ac964d51b]
class TLiquidity--><rect codeLine="81" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="86.8652" id="TLiquidity" style="stroke:#A80036;stroke-width:1.5;" width="96" x="1204" y="444.5"/><ellipse cx="1222.6" cy="460.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1225.0731,466.6431 Q1224.4921,466.9419 1223.8529,467.0913 Q1223.2138,467.2407 1222.5082,467.2407 Q1220.0014,467.2407 1218.6815,465.5889 Q1217.3617,463.937 1217.3617,460.8159 Q1217.3617,457.6865 1218.6815,456.0347 Q1220.0014,454.3828 1222.5082,454.3828 Q1223.2138,454.3828 1223.8612,454.5322 Q1224.5087,454.6816 1225.0731,454.9805 L1225.0731,457.7031 Q1224.4423,457.1221 1223.8488,456.8523 Q1223.2553,456.5825 1222.6244,456.5825 Q1221.2797,456.5825 1220.5949,457.6492 Q1219.9101,458.7158 1219.9101,460.8159 Q1219.9101,462.9077 1220.5949,463.9744 Q1221.2797,465.041 1222.6244,465.041 Q1223.2553,465.041 1223.8488,464.7712 Q1224.4423,464.5015 1225.0731,463.9204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="56" x="1237.4" y="465.0352">TLiquidity</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1205" x2="1299" y1="476.5" y2="476.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="1210" y="491.1348">int liquidity</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="84" x="1210" y="504.0898">nat updateLevel</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="52" x="1210" y="517.0449">bool valid</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1205" x2="1299" y1="523.3652" y2="523.3652"/><!--MD5=[631de81dc12e96d3e5582cb12d3402ea]
class TCalculation--><rect codeLine="87" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="125.7305" id="TCalculation" style="stroke:#A80036;stroke-width:1.5;" width="170" x="365" y="995"/><ellipse cx="410.75" cy="1011" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M413.2231,1017.1431 Q412.6421,1017.4419 412.0029,1017.5913 Q411.3638,1017.7407 410.6582,1017.7407 Q408.1514,1017.7407 406.8315,1016.0889 Q405.5117,1014.437 405.5117,1011.3159 Q405.5117,1008.1865 406.8315,1006.5347 Q408.1514,1004.8828 410.6582,1004.8828 Q411.3638,1004.8828 412.0112,1005.0322 Q412.6587,1005.1816 413.2231,1005.4805 L413.2231,1008.2031 Q412.5923,1007.6221 411.9988,1007.3523 Q411.4053,1007.0825 410.7744,1007.0825 Q409.4297,1007.0825 408.7449,1008.1492 Q408.0601,1009.2158 408.0601,1011.3159 Q408.0601,1013.4077 408.7449,1014.4744 Q409.4297,1015.541 410.7744,1015.541 Q411.4053,1015.541 411.9988,1015.2712 Q412.5923,1015.0015 413.2231,1014.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="70" x="431.25" y="1015.5352">TCalculation</text><line style="stroke:#A80036;stroke-width:1.5;" x1="366" x2="534" y1="1027" y2="1027"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="139" x="371" y="1041.6348">nat sumBorrowPlusEffects</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="94" x="371" y="1054.5898">nat sumCollateral</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="93" x="371" y="1067.5449">nat redeemToken</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="102" x="371" y="1080.5">nat borrowAmount</text><line style="stroke:#A80036;stroke-width:1.5;" x1="366" x2="534" y1="1086.8203" y2="1086.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="158" x="371" y="1101.4551">some(address) cTokenModify</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="126" x="371" y="1114.4102">some(address) account</text><!--MD5=[acf8b6681d15be3c0f8980ba30cd1bd3]
class TAccountLiquidityParams--><rect codeLine="96" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="99.8203" id="TAccountLiquidityParams" style="stroke:#A80036;stroke-width:1.5;" width="176" x="570" y="1008"/><ellipse cx="585" cy="1024" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M587.4731,1030.1431 Q586.8921,1030.4419 586.2529,1030.5913 Q585.6138,1030.7407 584.9082,1030.7407 Q582.4014,1030.7407 581.0815,1029.0889 Q579.7617,1027.437 579.7617,1024.3159 Q579.7617,1021.1865 581.0815,1019.5347 Q582.4014,1017.8828 584.9082,1017.8828 Q585.6138,1017.8828 586.2612,1018.0322 Q586.9087,1018.1816 587.4731,1018.4805 L587.4731,1021.2031 Q586.8423,1020.6221 586.2488,1020.3523 Q585.6553,1020.0825 585.0244,1020.0825 Q583.6797,1020.0825 582.9949,1021.1492 Q582.3101,1022.2158 582.3101,1024.3159 Q582.3101,1026.4077 582.9949,1027.4744 Q583.6797,1028.541 585.0244,1028.541 Q585.6553,1028.541 586.2488,1028.2712 Q586.8423,1028.0015 587.4731,1027.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="144" x="599" y="1028.5352">TAccountLiquidityParams</text><line style="stroke:#A80036;stroke-width:1.5;" x1="571" x2="745" y1="1040" y2="1040"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="121" x="576" y="1054.6348">address cTokenModify</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="576" y="1067.5898">address account</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="576" y="1080.5449">nat redeemTokens</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="102" x="576" y="1093.5">nat borrowAmount</text><line style="stroke:#A80036;stroke-width:1.5;" x1="571" x2="745" y1="1099.8203" y2="1099.8203"/><!--MD5=[42f8e3ea5ddf462f3bffc37d0f462112]
class Oracle.SetPriceParam--><rect codeLine="106" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="73.9102" id="Oracle.SetPriceParam" style="stroke:#A80036;stroke-width:1.5;" width="137" x="1356.5" y="451"/><ellipse cx="1381.85" cy="467" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1384.3231,473.1431 Q1383.7421,473.4419 1383.1029,473.5913 Q1382.4638,473.7407 1381.7582,473.7407 Q1379.2514,473.7407 1377.9315,472.0889 Q1376.6117,470.437 1376.6117,467.3159 Q1376.6117,464.1865 1377.9315,462.5347 Q1379.2514,460.8828 1381.7582,460.8828 Q1382.4638,460.8828 1383.1112,461.0322 Q1383.7587,461.1816 1384.3231,461.4805 L1384.3231,464.2031 Q1383.6923,463.6221 1383.0988,463.3523 Q1382.5053,463.0825 1381.8744,463.0825 Q1380.5297,463.0825 1379.8449,464.1492 Q1379.1601,465.2158 1379.1601,467.3159 Q1379.1601,469.4077 1379.8449,470.4744 Q1380.5297,471.541 1381.8744,471.541 Q1382.5053,471.541 1383.0988,471.2712 Q1383.6923,471.0015 1384.3231,470.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="82" x="1398.15" y="471.5352">SetPriceParam</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1357.5" x2="1492.5" y1="483" y2="483"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="125" x="1362.5" y="497.6348">TTimestamp timestamp</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="47" x="1362.5" y="510.5898">nat price</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1357.5" x2="1492.5" y1="516.9102" y2="516.9102"/><!--MD5=[771ccd8fb6ff3a1886cafec3885f2fd1]
class Exponential.TExp--><rect codeLine="113" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="60.9551" id="Exponential.TExp" style="stroke:#A80036;stroke-width:1.5;" width="80" x="1550" y="457.5"/><ellipse cx="1573.1" cy="473.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1575.5731,479.6431 Q1574.9921,479.9419 1574.3529,480.0913 Q1573.7138,480.2407 1573.0082,480.2407 Q1570.5014,480.2407 1569.1815,478.5889 Q1567.8617,476.937 1567.8617,473.8159 Q1567.8617,470.6865 1569.1815,469.0347 Q1570.5014,467.3828 1573.0082,467.3828 Q1573.7138,467.3828 1574.3612,467.5322 Q1575.0087,467.6816 1575.5731,467.9805 L1575.5731,470.7031 Q1574.9423,470.1221 1574.3488,469.8523 Q1573.7553,469.5825 1573.1244,469.5825 Q1571.7797,469.5825 1571.0949,470.6492 Q1570.4101,471.7158 1570.4101,473.8159 Q1570.4101,475.9077 1571.0949,476.9744 Q1571.7797,478.041 1573.1244,478.041 Q1573.7553,478.041 1574.3488,477.7712 Q1574.9423,477.5015 1575.5731,476.9204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="30" x="1588.9" y="478.0352">TExp</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1551" x2="1629" y1="489.5" y2="489.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="68" x="1556" y="504.1348">nat mantissa</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1551" x2="1629" y1="510.4551" y2="510.4551"/><!--MD5=[4665eca6f73aeb734cad2416ec67aa8f]
class CToken.TAccountSnapshot--><rect codeLine="119" fill="#FEFECE" filter="url(#f1q3fhcwp5m0pg)" height="99.8203" id="CToken.TAccountSnapshot" style="stroke:#A80036;stroke-width:1.5;" width="154" x="1686" y="438"/><ellipse cx="1708.65" cy="454" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1711.1231,460.1431 Q1710.5421,460.4419 1709.9029,460.5913 Q1709.2638,460.7407 1708.5582,460.7407 Q1706.0514,460.7407 1704.7315,459.0889 Q1703.4117,457.437 1703.4117,454.3159 Q1703.4117,451.1865 1704.7315,449.5347 Q1706.0514,447.8828 1708.5582,447.8828 Q1709.2638,447.8828 1709.9112,448.0322 Q1710.5587,448.1816 1711.1231,448.4805 L1711.1231,451.2031 Q1710.4923,450.6221 1709.8988,450.3523 Q1709.3053,450.0825 1708.6744,450.0825 Q1707.3297,450.0825 1706.6449,451.1492 Q1705.9601,452.2158 1705.9601,454.3159 Q1705.9601,456.4077 1706.6449,457.4744 Q1707.3297,458.541 1708.6744,458.541 Q1709.3053,458.541 1709.8988,458.2712 Q1710.4923,458.0015 1711.1231,457.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="105" x="1724.35" y="458.5352">TAccountSnapshot</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1687" x2="1839" y1="470" y2="470"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="89" x="1692" y="484.6348">address account</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="1692" y="497.5898">nat cTokenBalance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="1692" y="510.5449">nat borrowBalance</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1692" y="523.5">nat exchangeRateMantissa</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1687" x2="1839" y1="529.8203" y2="529.8203"/><!--MD5=[e61f216ec71afc1145a509fedc84f70f]
link Comptroller to TMarket--><!--MD5=[b132533ebb355e02c8b0d62e39f731eb]
link TMarket to TLiquidity--><!--MD5=[033c84675b26624a82b8a9ec12a20546]
link Comptroller to TCalculation--><!--MD5=[e15759577360172511accecc72fad6aa]
link TCalculation to TAccountLiquidityParams--><!--MD5=[8606bd18f5da47f0576070eb90aa3aec]
@startuml comptroller
package Comptroller {
  class Comptroller {
    - - storage - -
    map(address => set(address)) account_assets
    bool borrowAllowed()
    address administrator
    address pendingAdministrator
    map(address -> TMarket) markets
    map(string -> address) marketNameToAddress
    bool transferPaused
    map(address -> set(address)) account_assets
    big_map(address -> TLiquidity) account_liquidity = sp.big_map(l={}, tkey = sp.TAddress, tvalue = TLiquidity), # Per-account mapping of current liquidity
    oracleAddress = oracleAddress_,
    activeOperations = sp.set(t=sp.TNat), # Set of currently active operations to protect execution flow
    TCalculation calculation
    nat closeFactorMantissa
    nat liquidationIncentiveMantissa
    nat pricePeriodRelevance
    nat liquidityPeriodRelevance
    - - entry points - -
    +enterMarkets(cTokens: list(address))
    -addToMarketInternal(ctoken: address, borrower: address)
    +exitMarket(ctoken: address)
    +setAccountSnapAndExitMarket(accountSnapshot: CToken.TAccountSnapshot)
    +mintAllowed(ctoken: address, minter: address, mintAmount: nat)
    +redeemAllowed(ctoken: address, redeemer: address, redeemAmount: nat)
    -redeemAllowedInternal(ctoken: address, redeemer: address, redeemAmount: nat)
    -checkInsufficientLquidityInternal(ctoken: address, account: address, amount: nat)
    +borrowAllowed(ctoken: address, borrower: address, borrowAmount: nat)
    -checkPriceErrors(ctoken: address)
    +repayBorrowAllowed(ctoken: address, payer: address, borrower: address, repayAmount: nat)
    +transferAllowed(ctoken: address, src: address, dst: address, transferTokens: nat)
    +updateAssetPrice(asset: address)
    +setAssetPrice((assetName, pricePair): (string, Oracle.TSetPricePriceParams))
    -getAssetPrice(asset: address)
    +updateAccountLiduiqity(account: address)
    +setAccountLiquidity()
    +getHypoAccountLiquidity(data: TAccountLiquidityParams, callback: contract(int))
    +int returnHypoAccountLiquidity()
    -calcluateCurrentAccountLiquidity(account: address)
    -calcluateAccountLiquidity(account: address)
    -initCalculation(cTokenModify: address, account: address, redeemTokens: , borrowAmount: )
    -resetCalculation()
    -getAccountLiquidityForAsset(asset: address, account: address)
    +calculateAccountAssetLiquidity(params: TAccountSnapshot)
    +setPricePeriodRelevance(blockNumber: nat)
    +setLiquidityPeriodRelevance(blockNumber: nat)
    +setPendingGovernance(pendingAdministrator: address)
    +acceptGovernance()
    +setMintPaused(cToken: address, state: bool)
    +setBorrowPaused(cToken: address, state: bool)
    +setTransferPaused(state: bool)
    +setPriceOracle(priceOracle: address)
    +setCloseFactor(closeFactorMantissa: nat)
    +setCollateralFactor(cToken: address, newCollateralFactor: nat)
    +setLiquidationIncentive(liquidationIncentiveMantissa: nat)
    +supportMarket(cToken: address, name: string)
    +disableMarket(cToken: address)
    +setMarketBorrowCap(cToken: address, newBorrowCap: nat)
    - - helpers - -
    -verifyMarketExists(token: address)
    -verifyMarketExists(token: address)
    -verifyMarketNotListed(token: address)
    -verifyAdministrator()
    -verifyInternal()
    -verifyLiquidityCorrect(account: address)
    -invalidateLiquidity(account: address)
  }

  class TMarket {
    Exponential.TExp collateralFactor
    big_map(address -> bool) accountMembership
    bool mintPaused
    bool borrowPaused
    string name
    Exponential.TExp price
    nat updateLevel
    nat borrowCap
  }

  class TLiquidity {
    int liquidity
    nat updateLevel
    bool valid
  }

  class TCalculation {
    nat sumBorrowPlusEffects
    nat sumCollateral
    some(address) cTokenModify
    some(address) account
    nat redeemToken
    nat borrowAmount
  }

  class TAccountLiquidityParams {
    address cTokenModify
    address account
    nat redeemTokens
    nat borrowAmount
  }

}

package Oracle {
  class Oracle.SetPriceParam {
    TTimestamp timestamp
    nat price
  }
}

package Exponential {
  class Exponential.TExp {
    nat mantissa
  }
}

package CToken {
  class CToken.TAccountSnapshot {
    address account
    nat cTokenBalance
    nat borrowBalance
    nat exchangeRateMantissa
  }
}
@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>