<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="759px" preserveAspectRatio="none" style="width:1386px;height:759px;" version="1.1" viewBox="0 0 1386 759" width="1386px" zoomAndPan="magnify"><defs><filter height="300%" id="fw5hgouip6f1l" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="88.4883" y2="674.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="145" x2="145" y1="88.4883" y2="674.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="742" x2="742" y1="88.4883" y2="674.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="85.5352">User</text><ellipse cx="23.5" cy="15" fill="#FEFECE" filter="url(#fw5hgouip6f1l)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,23 L23.5,50 M10.5,31 L36.5,31 M23.5,50 L10.5,65 M23.5,50 L36.5,65 " fill="none" filter="url(#fw5hgouip6f1l)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="687.3711">User</text><ellipse cx="23.5" cy="700.3242" fill="#FEFECE" filter="url(#fw5hgouip6f1l)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,708.3242 L23.5,735.3242 M10.5,716.3242 L36.5,716.3242 M23.5,735.3242 L10.5,750.3242 M23.5,735.3242 L36.5,750.3242 " fill="none" filter="url(#fw5hgouip6f1l)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fw5hgouip6f1l)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="110" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="117" y="73.5352">CToken</text><rect fill="#FEFECE" filter="url(#fw5hgouip6f1l)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="110" y="673.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="117" y="694.3711">CToken</text><rect fill="#FEFECE" filter="url(#fw5hgouip6f1l)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="692" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="699" y="73.5352">Comptroller</text><rect fill="#FEFECE" filter="url(#fw5hgouip6f1l)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="692" y="673.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="699" y="694.3711">Comptroller</text><polygon fill="#A80036" points="133.5,115.7988,143.5,119.7988,133.5,123.7988,137.5,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="139.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="30.5" y="115.0566">borrow(params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="149.1094" y2="149.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="149.1094" y2="162.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="162.1094" y2="162.1094"/><polygon fill="#A80036" points="156.5,158.1094,146.5,162.1094,156.5,166.1094,152.5,162.1094" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="152.5" y="144.3672">verifyNotInternal()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="191.4199" y2="191.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="191.4199" y2="204.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="204.4199" y2="204.4199"/><polygon fill="#A80036" points="156.5,200.4199,146.5,204.4199,156.5,208.4199,152.5,204.4199" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="451" x="152.5" y="186.6777">verifyBorrowAllowed(borrower_ = sp.sender, borrowAmount_ = params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="233.7305" y2="233.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="233.7305" y2="246.7305"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="246.7305" y2="246.7305"/><polygon fill="#A80036" points="156.5,242.7305,146.5,246.7305,156.5,250.7305,152.5,246.7305" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283" x="152.5" y="228.9883">addAddressIfNecessary(address = sp.sender)</text><polygon fill="#A80036" points="730.5,272.041,740.5,276.041,730.5,280.041,734.5,276.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="736.5" y1="276.041" y2="276.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="573" x="152.5" y="271.2988">borrowAllowed(cToken = sp.self_address, borrower = sp.sender, borrowAmount = params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="742.5" x2="784.5" y1="305.3516" y2="305.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="784.5" x2="784.5" y1="305.3516" y2="318.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="743.5" x2="784.5" y1="318.3516" y2="318.3516"/><polygon fill="#A80036" points="753.5,314.3516,743.5,318.3516,753.5,322.3516,749.5,318.3516" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="749.5" y="300.6094">verifyMarketListed(cToken)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="742.5" x2="784.5" y1="347.6621" y2="347.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="784.5" x2="784.5" y1="347.6621" y2="360.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="743.5" x2="784.5" y1="360.6621" y2="360.6621"/><polygon fill="#A80036" points="753.5,356.6621,743.5,360.6621,753.5,364.6621,749.5,360.6621" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401" x="749.5" y="342.9199">addToMarketInternal(cToken = sp.sender, borrower = borrower)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="742.5" x2="784.5" y1="389.9727" y2="389.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="784.5" x2="784.5" y1="389.9727" y2="402.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="743.5" x2="784.5" y1="402.9727" y2="402.9727"/><polygon fill="#A80036" points="753.5,398.9727,743.5,402.9727,753.5,406.9727,749.5,402.9727" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="630" x="749.5" y="385.2305">checkInsufficientLiquidityInternal(cToken = cToken, account = borrower, amount = borrowAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="742.5" x2="784.5" y1="432.2832" y2="432.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="784.5" x2="784.5" y1="432.2832" y2="445.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="743.5" x2="784.5" y1="445.2832" y2="445.2832"/><polygon fill="#A80036" points="753.5,441.2832,743.5,445.2832,753.5,449.2832,749.5,445.2832" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="749.5" y="427.541">invalidateLiquidity(borrower)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="474.5938" y2="474.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="474.5938" y2="487.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="487.5938" y2="487.5938"/><polygon fill="#A80036" points="156.5,483.5938,146.5,487.5938,156.5,491.5938,152.5,487.5938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="401" x="152.5" y="469.8516">borrowInternal(borrower = sp.sender, borrowAmount = params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="516.9043" y2="516.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="516.9043" y2="529.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="529.9043" y2="529.9043"/><polygon fill="#A80036" points="156.5,525.9043,146.5,529.9043,156.5,533.9043,152.5,529.9043" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="152.5" y="512.1621">checkCash(borrowAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="559.2148" y2="559.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="559.2148" y2="572.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="572.2148" y2="572.2148"/><polygon fill="#A80036" points="156.5,568.2148,146.5,572.2148,156.5,576.2148,152.5,572.2148" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="152.5" y="554.4727">verifyAccrueInterestRelevance()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="601.5254" y2="601.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="601.5254" y2="614.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="614.5254" y2="614.5254"/><polygon fill="#A80036" points="156.5,610.5254,146.5,614.5254,156.5,618.5254,152.5,614.5254" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341" x="152.5" y="596.7832">doTransferOut(to_: borrower, amount: borrowAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="187.5" y1="643.8359" y2="643.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="187.5" x2="187.5" y1="643.8359" y2="656.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="146.5" x2="187.5" y1="656.8359" y2="656.8359"/><polygon fill="#A80036" points="156.5,652.8359,146.5,656.8359,156.5,660.8359,152.5,656.8359" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="152.5" y="639.0938">invalidateAccrueInterest()</text><!--MD5=[48f3470691c70821a0ca13e05154a3ed]
@startuml borrow
actor User
participant CToken
participant Comptroller

User -> CToken : borrow(params)
CToken -> CToken : verifyNotInternal()
CToken -> CToken : verifyBorrowAllowed(borrower_ = sp.sender, borrowAmount_ = params)
CToken -> CToken : addAddressIfNecessary(address = sp.sender)
CToken -> Comptroller : borrowAllowed(cToken = sp.self_address, borrower = sp.sender, borrowAmount = params)
Comptroller -> Comptroller : verifyMarketListed(cToken)
Comptroller -> Comptroller : addToMarketInternal(cToken = sp.sender, borrower = borrower)
Comptroller -> Comptroller : checkInsufficientLiquidityInternal(cToken = cToken, account = borrower, amount = borrowAmount)
Comptroller -> Comptroller : invalidateLiquidity(borrower)
CToken -> CToken : borrowInternal(borrower = sp.sender, borrowAmount = params)
CToken -> CToken : checkCash(borrowAmount)
CToken -> CToken : verifyAccrueInterestRelevance()
CToken -> CToken : doTransferOut(to_: borrower, amount: borrowAmount)
CToken -> CToken : invalidateAccrueInterest()

@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>