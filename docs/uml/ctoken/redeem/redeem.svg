<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="832px" preserveAspectRatio="none" style="width:1499px;height:832px;" version="1.1" viewBox="0 0 1499 832" width="1499px" zoomAndPan="magnify"><defs><filter height="300%" id="f199nrwsmruqk2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f199nrwsmruqk2)" height="59.6211" style="stroke:#000000;stroke-width:2.0;" width="678.5" x="751" y="333.3516"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="88.4883" y2="748.457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="147" x2="147" y1="88.4883" y2="748.457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="811" x2="811" y1="88.4883" y2="748.457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="85.5352">User</text><ellipse cx="23.5" cy="15" fill="#FEFECE" filter="url(#f199nrwsmruqk2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,23 L23.5,50 M10.5,31 L36.5,31 M23.5,50 L10.5,65 M23.5,50 L36.5,65 " fill="none" filter="url(#f199nrwsmruqk2)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="760.9922">User</text><ellipse cx="23.5" cy="773.9453" fill="#FEFECE" filter="url(#f199nrwsmruqk2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,781.9453 L23.5,808.9453 M10.5,789.9453 L36.5,789.9453 M23.5,808.9453 L10.5,823.9453 M23.5,808.9453 L36.5,823.9453 " fill="none" filter="url(#f199nrwsmruqk2)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f199nrwsmruqk2)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="112" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="119" y="73.5352">CToken</text><rect fill="#FEFECE" filter="url(#f199nrwsmruqk2)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="112" y="747.457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="119" y="767.9922">CToken</text><rect fill="#FEFECE" filter="url(#f199nrwsmruqk2)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="761" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="768" y="73.5352">Comptroller</text><rect fill="#FEFECE" filter="url(#f199nrwsmruqk2)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="761" y="747.457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="768" y="767.9922">Comptroller</text><polygon fill="#A80036" points="135.5,115.7988,145.5,119.7988,135.5,123.7988,139.5,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="141.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="30.5" y="115.0566">redeem(params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="149.1094" y2="149.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="149.1094" y2="162.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="162.1094" y2="162.1094"/><polygon fill="#A80036" points="158.5,158.1094,148.5,162.1094,158.5,166.1094,154.5,162.1094" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="154.5" y="144.3672">verifyNotInternal()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="191.4199" y2="191.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="191.4199" y2="204.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="204.4199" y2="204.4199"/><polygon fill="#A80036" points="158.5,200.4199,148.5,204.4199,158.5,208.4199,154.5,204.4199" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461" x="154.5" y="186.6777">verifyRedeemAllowed(redeemer_ = sp.sender, redeemAmount_ = params)</text><polygon fill="#A80036" points="799.5,229.7305,809.5,233.7305,799.5,237.7305,803.5,233.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="805.5" y1="233.7305" y2="233.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="640" x="154.5" y="228.9883">redeemAllowed(cToken = sp.self_address, redeemer = redeemer_, redeemAmount = redeemAmount_)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="811.5" x2="853.5" y1="263.041" y2="263.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="853.5" x2="853.5" y1="263.041" y2="276.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="812.5" x2="853.5" y1="276.041" y2="276.041"/><polygon fill="#A80036" points="822.5,272.041,812.5,276.041,822.5,280.041,818.5,276.041" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="674" x="818.5" y="258.2988">redeemAllowedInternal(cToken = sp.self_address, redeemer = redeemer, redeemAmount = redeemAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="811.5" x2="853.5" y1="305.3516" y2="305.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="853.5" x2="853.5" y1="305.3516" y2="318.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="812.5" x2="853.5" y1="318.3516" y2="318.3516"/><polygon fill="#A80036" points="822.5,314.3516,812.5,318.3516,822.5,322.3516,818.5,318.3516" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="818.5" y="300.6094">verifyMarketListed(cToken)</text><path d="M751,333.3516 L813,333.3516 L813,340.3516 L803,350.3516 L751,350.3516 L751,333.3516 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="59.6211" style="stroke:#000000;stroke-width:2.0;" width="678.5" x="751" y="333.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="766" y="346.9199">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="515" x="828" y="345.9863">[if market.accountMembership.contains(redeemer) &amp; market.accountMembership[redeemer]]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="811.5" x2="853.5" y1="371.9727" y2="371.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="853.5" x2="853.5" y1="371.9727" y2="384.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="812.5" x2="853.5" y1="384.9727" y2="384.9727"/><polygon fill="#A80036" points="822.5,380.9727,812.5,384.9727,822.5,388.9727,818.5,384.9727" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="599" x="818.5" y="367.2305">checkInsuffLiquidityInternal(cToken = cToken, account = redeemer, amount = redeemAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="811.5" x2="853.5" y1="421.2832" y2="421.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="853.5" x2="853.5" y1="421.2832" y2="434.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="812.5" x2="853.5" y1="434.2832" y2="434.2832"/><polygon fill="#A80036" points="822.5,430.2832,812.5,434.2832,822.5,438.2832,818.5,434.2832" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="818.5" y="416.541">invalidateLiquidity(redeemer)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="463.5938" y2="463.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="463.5938" y2="476.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="476.5938" y2="476.5938"/><polygon fill="#A80036" points="158.5,472.5938,148.5,476.5938,158.5,480.5938,154.5,476.5938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="537" x="154.5" y="458.8516">redeemInternal(redeemer = sp.sender, redeemAmount = params, isUnderlying = true)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="505.9043" y2="505.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="505.9043" y2="518.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="518.9043" y2="518.9043"/><polygon fill="#A80036" points="158.5,514.9043,148.5,518.9043,158.5,522.9043,154.5,518.9043" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="473" x="154.5" y="501.1621">getRedeemAmount(amount = redeemAmount, isUnderlying = isUnderlying)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="548.2148" y2="548.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="548.2148" y2="561.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="561.2148" y2="561.2148"/><polygon fill="#A80036" points="158.5,557.2148,148.5,561.2148,158.5,565.2148,154.5,561.2148" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="469" x="154.5" y="543.4727">getRedeemTokens(amount = redeemAmount, isUnderlying = isUnderlying)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="590.5254" y2="590.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="590.5254" y2="603.5254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="603.5254" y2="603.5254"/><polygon fill="#A80036" points="158.5,599.5254,148.5,603.5254,158.5,607.5254,154.5,603.5254" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238" x="154.5" y="585.7832">checkCash(amount = redeemAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="632.8359" y2="632.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="632.8359" y2="645.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="645.8359" y2="645.8359"/><polygon fill="#A80036" points="158.5,641.8359,148.5,645.8359,158.5,649.8359,154.5,645.8359" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="154.5" y="628.0938">verifyAccruedInterestRelevance()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="675.1465" y2="675.1465"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="675.1465" y2="688.1465"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="688.1465" y2="688.1465"/><polygon fill="#A80036" points="158.5,684.1465,148.5,688.1465,158.5,692.1465,154.5,688.1465" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365" x="154.5" y="670.4043">doTransferOut(to_ = redeemer, amount = redeemAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="147.5" x2="189.5" y1="717.457" y2="717.457"/><line style="stroke:#A80036;stroke-width:1.0;" x1="189.5" x2="189.5" y1="717.457" y2="730.457"/><line style="stroke:#A80036;stroke-width:1.0;" x1="148.5" x2="189.5" y1="730.457" y2="730.457"/><polygon fill="#A80036" points="158.5,726.457,148.5,730.457,158.5,734.457,154.5,730.457" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="154.5" y="712.7148">invalidateAccruedInterest()</text><!--MD5=[8564e95f7a19a561afc341cdef03b7b6]
@startuml redeem
Actor User
participant CToken
participant Comptroller

User -> CToken : redeem(params)
CToken -> CToken : verifyNotInternal()
CToken -> CToken : verifyRedeemAllowed(redeemer_ = sp.sender, redeemAmount_ = params)
CToken -> Comptroller : redeemAllowed(cToken = sp.self_address, redeemer = redeemer_, redeemAmount = redeemAmount_)
Comptroller -> Comptroller : redeemAllowedInternal(cToken = sp.self_address, redeemer = redeemer, redeemAmount = redeemAmount)
Comptroller -> Comptroller : verifyMarketListed(cToken)
alt if market.accountMembership.contains(redeemer) & market.accountMembership[redeemer]
    Comptroller -> Comptroller : checkInsuffLiquidityInternal(cToken = cToken, account = redeemer, amount = redeemAmount)
end
Comptroller -> Comptroller : invalidateLiquidity(redeemer)
CToken -> CToken : redeemInternal(redeemer = sp.sender, redeemAmount = params, isUnderlying = true)
CToken -> CToken : getRedeemAmount(amount = redeemAmount, isUnderlying = isUnderlying)
CToken -> CToken : getRedeemTokens(amount = redeemAmount, isUnderlying = isUnderlying)
CToken -> CToken : checkCash(amount = redeemAmount)
CToken -> CToken : verifyAccruedInterestRelevance()
CToken -> CToken : doTransferOut(to_ = redeemer, amount = redeemAmount)
CToken -> CToken : invalidateAccruedInterest()
@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>