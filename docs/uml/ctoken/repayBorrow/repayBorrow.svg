<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="674px" preserveAspectRatio="none" style="width:1113px;height:674px;" version="1.1" viewBox="0 0 1113 674" width="1113px" zoomAndPan="magnify"><defs><filter height="300%" id="f1keyouoh8zu6" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="88.4883" y2="590.2148"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="178" x2="178" y1="88.4883" y2="590.2148"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="919" x2="919" y1="88.4883" y2="590.2148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="85.5352">User</text><ellipse cx="23.5" cy="15" fill="#FEFECE" filter="url(#f1keyouoh8zu6)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,23 L23.5,50 M10.5,31 L36.5,31 M23.5,50 L10.5,65 M23.5,50 L36.5,65 " fill="none" filter="url(#f1keyouoh8zu6)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="602.75">User</text><ellipse cx="23.5" cy="615.7031" fill="#FEFECE" filter="url(#f1keyouoh8zu6)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,623.7031 L23.5,650.7031 M10.5,631.7031 L36.5,631.7031 M23.5,650.7031 L10.5,665.7031 M23.5,650.7031 L36.5,665.7031 " fill="none" filter="url(#f1keyouoh8zu6)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1keyouoh8zu6)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="143" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="150" y="73.5352">CToken</text><rect fill="#FEFECE" filter="url(#f1keyouoh8zu6)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="67" x="143" y="589.2148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="150" y="609.75">CToken</text><rect fill="#FEFECE" filter="url(#f1keyouoh8zu6)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="869" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="876" y="73.5352">Comptroller</text><rect fill="#FEFECE" filter="url(#f1keyouoh8zu6)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="97" x="869" y="589.2148"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="876" y="609.75">Comptroller</text><polygon fill="#A80036" points="166.5,115.7988,176.5,119.7988,166.5,123.7988,170.5,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="172.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="30.5" y="115.0566">repayBorrow(params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="149.1094" y2="149.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="149.1094" y2="162.1094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="162.1094" y2="162.1094"/><polygon fill="#A80036" points="189.5,158.1094,179.5,162.1094,189.5,166.1094,185.5,162.1094" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="185.5" y="144.3672">verifyNotInternal()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="191.4199" y2="191.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="191.4199" y2="204.4199"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="204.4199" y2="204.4199"/><polygon fill="#A80036" points="189.5,200.4199,179.5,204.4199,189.5,208.4199,185.5,204.4199" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="585" x="185.5" y="186.6777">verifyRepayBorrowAllowed(payer = sp.sender, borrower = sp.sender, repayAmount = params)</text><polygon fill="#A80036" points="907.5,229.7305,917.5,233.7305,907.5,237.7305,911.5,233.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="913.5" y1="233.7305" y2="233.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="717" x="185.5" y="228.9883">repayBorrowAllowed(cToken = sp.self_address, payer = sp.sender, borrower = sp.sender, repayAmount = params)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="919.5" x2="961.5" y1="263.041" y2="263.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="961.5" x2="961.5" y1="263.041" y2="276.041"/><line style="stroke:#A80036;stroke-width:1.0;" x1="920.5" x2="961.5" y1="276.041" y2="276.041"/><polygon fill="#A80036" points="930.5,272.041,920.5,276.041,930.5,280.041,926.5,276.041" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="926.5" y="258.2988">verifyMarketListed(cToken)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="919.5" x2="961.5" y1="305.3516" y2="305.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="961.5" x2="961.5" y1="305.3516" y2="318.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="920.5" x2="961.5" y1="318.3516" y2="318.3516"/><polygon fill="#A80036" points="930.5,314.3516,920.5,318.3516,930.5,322.3516,926.5,318.3516" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="926.5" y="300.6094">invalidateLiquidity(payer)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="919.5" x2="961.5" y1="347.6621" y2="347.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="961.5" x2="961.5" y1="347.6621" y2="360.6621"/><line style="stroke:#A80036;stroke-width:1.0;" x1="920.5" x2="961.5" y1="360.6621" y2="360.6621"/><polygon fill="#A80036" points="930.5,356.6621,920.5,360.6621,930.5,364.6621,926.5,360.6621" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="926.5" y="342.9199">invalidateLiquidity(borrower)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="389.9727" y2="389.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="389.9727" y2="402.9727"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="402.9727" y2="402.9727"/><polygon fill="#A80036" points="189.5,398.9727,179.5,402.9727,189.5,406.9727,185.5,402.9727" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="578" x="185.5" y="385.2305">repayBorrowInternal(payer = sp.sender, borrower = borrower, repayAmount = repayAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="432.2832" y2="432.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="432.2832" y2="445.2832"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="445.2832" y2="445.2832"/><polygon fill="#A80036" points="189.5,441.2832,179.5,445.2832,189.5,449.2832,185.5,445.2832" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="185.5" y="427.541">verifyAccruedInterestRelevance()</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="474.5938" y2="474.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="474.5938" y2="487.5938"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="487.5938" y2="487.5938"/><polygon fill="#A80036" points="189.5,483.5938,179.5,487.5938,189.5,491.5938,185.5,487.5938" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="185.5" y="469.8516">getBorrowBalance(borrower)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="516.9043" y2="516.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="516.9043" y2="529.9043"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="529.9043" y2="529.9043"/><polygon fill="#A80036" points="189.5,525.9043,179.5,529.9043,189.5,533.9043,185.5,529.9043" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="185.5" y="512.1621">doTransferIn(from_ = payer, amount = repayAmount)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="178.5" x2="220.5" y1="559.2148" y2="559.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="220.5" x2="220.5" y1="559.2148" y2="572.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="179.5" x2="220.5" y1="572.2148" y2="572.2148"/><polygon fill="#A80036" points="189.5,568.2148,179.5,572.2148,189.5,576.2148,185.5,572.2148" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="185.5" y="554.4727">invalidateAccruedInterest()</text><!--MD5=[8fc24ea3066c365014508526b9add85e]
@startuml repayBorrow
Actor User
participant CToken
participant Comptroller

User -> CToken : repayBorrow(params)
CToken -> CToken : verifyNotInternal()
CToken -> CToken : verifyRepayBorrowAllowed(payer = sp.sender, borrower = sp.sender, repayAmount = params)
CToken -> Comptroller : repayBorrowAllowed(cToken = sp.self_address, payer = sp.sender, borrower = sp.sender, repayAmount = params)
Comptroller -> Comptroller : verifyMarketListed(cToken)
Comptroller -> Comptroller : invalidateLiquidity(payer)
Comptroller -> Comptroller : invalidateLiquidity(borrower)
CToken -> CToken : repayBorrowInternal(payer = sp.sender, borrower = borrower, repayAmount = repayAmount)
CToken -> CToken : verifyAccruedInterestRelevance()
CToken -> CToken : getBorrowBalance(borrower)
CToken -> CToken : doTransferIn(from_ = payer, amount = repayAmount)
CToken -> CToken : invalidateAccruedInterest()
@enduml

PlantUML version 1.2021.00(Sun Jan 10 05:25:05 EST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>